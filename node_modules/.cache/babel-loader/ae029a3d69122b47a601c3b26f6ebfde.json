{"ast":null,"code":"import _asyncToGenerator from\"/Users/abhijeetsingh/My Data/my data/EazyPark ReactJs/eduorg/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/abhijeetsingh/My Data/my data/EazyPark ReactJs/eduorg/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import{useSelector}from\"react-redux\";import{appConfig}from\"../config\";import{store}from\"../store\";var mainDomain=appConfig.mainDomain;var Api=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(endpoint,isauthenticated,method,body,contentType){var newState,headers,response,errObj,status;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;newState=store.getState().user.loginToken;headers={Accept:\"application/json\",\"Content-Type\":contentType||\"application/json\",\"Access-Control-Allow-Origin\":\"http://localhost:3000\",\"Access-Control-Allow-Credentials\":\"true\"};if(isauthenticated){headers={Authorization:\"Bearer  \".concat(newState),Accept:\"application/json\",\"Content-Type\":contentType||\"application/json\"};}_context.next=6;return axios({url:\"\".concat(mainDomain,\"/\").concat(endpoint),method:method||\"GET\",data:body,headers:headers,responseType:\"json\"});case 6:response=_context.sent;return _context.abrupt(\"return\",response);case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);if(!(_context.t0.response!==undefined)){_context.next=18;break;}errObj=_context.t0.response;status=_context.t0.response.status;if(status==401){localStorage.removeItem(\"persist:persist-root\");window.location.assign(\"/\");}console.log(\"return success to frontend\",_context.t0.response);return _context.abrupt(\"return\",errObj);case 18:console.log(\"return success to sssss\",_context.t0);return _context.abrupt(\"return\",_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function Api(_x,_x2,_x3,_x4,_x5){return _ref.apply(this,arguments);};}();store.subscribe(Api);export default Api;","map":{"version":3,"sources":["/Users/abhijeetsingh/My Data/my data/EazyPark ReactJs/eduorg/src/utils/APICaller.js"],"names":["axios","useSelector","appConfig","store","mainDomain","Api","endpoint","isauthenticated","method","body","contentType","newState","getState","user","loginToken","headers","Accept","Authorization","url","data","responseType","response","undefined","errObj","status","localStorage","removeItem","window","location","assign","console","log","subscribe"],"mappings":"uSAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,SAAT,KAA0B,WAA1B,CACA,OAASC,KAAT,KAAsB,UAAtB,CACA,GAAQC,CAAAA,UAAR,CAAuBF,SAAvB,CAAQE,UAAR,CAEA,GAAMC,CAAAA,GAAG,0FAAG,iBAAOC,QAAP,CAAiBC,eAAjB,CAAkCC,MAAlC,CAA0CC,IAA1C,CAAgDC,WAAhD,8KAEJC,QAFI,CAEOR,KAAK,CAACS,QAAN,GAAiBC,IAAjB,CAAsBC,UAF7B,CAGJC,OAHI,CAGM,CACZC,MAAM,CAAE,kBADI,CAEZ,eAAgBN,WAAW,EAAI,kBAFnB,CAGZ,8BAA+B,uBAHnB,CAIZ,mCAAoC,MAJxB,CAHN,CASR,GAAIH,eAAJ,CAAqB,CACnBQ,OAAO,CAAG,CACRE,aAAa,mBAAaN,QAAb,CADL,CAERK,MAAM,CAAE,kBAFA,CAGR,eAAgBN,WAAW,EAAI,kBAHvB,CAAV,CAKD,CAfO,sBAiBeV,CAAAA,KAAK,CAAC,CAC3BkB,GAAG,WAAKd,UAAL,aAAmBE,QAAnB,CADwB,CAE3BE,MAAM,CAAEA,MAAM,EAAI,KAFS,CAG3BW,IAAI,CAAEV,IAHqB,CAI3BM,OAAO,CAAEA,OAJkB,CAK3BK,YAAY,CAAE,MALa,CAAD,CAjBpB,QAiBFC,QAjBE,+CAyBDA,QAzBC,iEA2BJ,YAAMA,QAAN,GAAmBC,SA3Bf,2BA4BAC,MA5BA,CA4BS,YAAMF,QA5Bf,CA6BEG,MA7BF,CA6Ba,YAAMH,QA7BnB,CA6BEG,MA7BF,CA8BN,GAAIA,MAAM,EAAI,GAAd,CAAmB,CACjBC,YAAY,CAACC,UAAb,CAAwB,sBAAxB,EACAC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,GAAvB,EACD,CACDC,OAAO,CAACC,GAAR,CAAY,4BAAZ,CAA0C,YAAMV,QAAhD,EAlCM,gCAoCCE,MApCD,UAsCRO,OAAO,CAACC,GAAR,CAAY,yBAAZ,cAtCQ,kHAAH,kBAAH1B,CAAAA,GAAG,4DAAT,CA2CAF,KAAK,CAAC6B,SAAN,CAAgB3B,GAAhB,EAEA,cAAeA,CAAAA,GAAf","sourcesContent":["import axios from \"axios\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { appConfig } from \"../config\";\r\nimport { store } from \"../store\";\r\nconst { mainDomain } = appConfig;\r\n\r\nconst Api = async (endpoint, isauthenticated, method, body, contentType) => {\r\n  try {\r\n    var newState = store.getState().user.loginToken;\r\n    let headers = {\r\n      Accept: \"application/json\",\r\n      \"Content-Type\": contentType || \"application/json\",\r\n      \"Access-Control-Allow-Origin\": \"http://localhost:3000\",\r\n      \"Access-Control-Allow-Credentials\": \"true\",\r\n    };\r\n    if (isauthenticated) {\r\n      headers = {\r\n        Authorization: `Bearer  ${newState}`,\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": contentType || \"application/json\",\r\n      };\r\n    }\r\n\r\n    const response = await axios({\r\n      url: `${mainDomain}/${endpoint}`,\r\n      method: method || \"GET\",\r\n      data: body,\r\n      headers: headers,\r\n      responseType: \"json\",\r\n    });\r\n\r\n    return response;\r\n  } catch (error) {\r\n    if (error.response !== undefined) {\r\n      const errObj = error.response;\r\n      const { status } = error.response;\r\n      if (status == 401) {\r\n        localStorage.removeItem(\"persist:persist-root\");\r\n        window.location.assign(\"/\");\r\n      }\r\n      console.log(\"return success to frontend\", error.response);\r\n\r\n      return errObj; // return success to frontend\r\n    }\r\n    console.log(\"return success to sssss\", error);\r\n    return error;\r\n  }\r\n};\r\n\r\nstore.subscribe(Api);\r\n\r\nexport default Api;\r\n"]},"metadata":{},"sourceType":"module"}